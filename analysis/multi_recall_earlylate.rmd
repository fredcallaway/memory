---
title: Multi-cue recall (late trials only)
date: "`r Sys.Date()`"
author: "fredcallaway"
output:
  rmdformats::robobook:
    code_folding: hide
    self_contained: true
  output:
    pdf_document:
      latex_engine: xelatex
---


```{r setup, include=FALSE}
source("setup.r")
knitr::opts_chunk$set(fig.path="figs/multi")
source("load_data.r")
late_def = 10
multi = multi %>% mutate(phase = if_else(trial_num > late_def, "late", "early"))
```

::: {.alert .alert-info}
**Info:** These are all the main analyses split by early/late in the critical round.
We define "late" as after trial `r late_def`
:::


# Participants

- N = `r nrow(participants)`
- This combines the previous dataset (N = 40) with one collected on May 20 (N=29).


# Proportion presentation time

The simplest test of rational memory: do people spend more time looking at the cue
that they have a stronger memory of? This analysis only considers trials where
both cues are seen. We control for the last presentaiton, per the earlier discussion.


```{r,fig.width=7, fig.height=3.5}
X = multi %>% 
    filter(n_pres > 1)

X %>% ggplot(aes(rel_strength, prop_first, color=last_pres)) +
    stat_summary_bin(fun.data=mean_cl_boot, bins=5) +
    geom_smooth(method='lm') +
    facet_wrap(~ phase)

X %>% filter(phase == "early") %>% 
    lmer(prop_first ~ rel_strength * last_pres + (rel_strength * last_pres | wid), data=.) %>% summ

X %>% filter(phase == "late") %>% 
    lmer(prop_first ~ rel_strength * last_pres + (rel_strength * last_pres | wid), data=.) %>% summ
```

Note: here and everywhere else, **the first regression table is for early
trials and the second is for late trials.**

# First presentation duration

Consider only the trials with more than one presentation.
Do participants switch away from the first image more quickly when they have
a worse memory of it?

```{r, fig.width=7, fig.height=3.5}
X = multi %>% 
    filter(n_pres > 1)

X %>% ggplot(aes(strength_first, first_pres_time)) + 
    stat_summary_bin(fun.data=mean_cl_boot, bins=10) +
    facet_wrap(~ phase) +
    geom_smooth(method='lm')

X %>% filter(phase == "early") %>% lmer(first_pres_time ~ strength_first + (strength_first|wid), data=.) %>% summ
X %>% filter(phase == "late") %>% lmer(first_pres_time ~ strength_first + (strength_first|wid), data=.) %>% summ
```

The fixed-effects regression line is worse, but the mixed effects gives an almost significant result
in the correct direction (for the late trials). Strange.


# Second fixation duration

We can do a similar analysis for the second presentation duration. In this case,
however, the duration may depend on the strength of both the first and second cues.

```{r, fig.width=7, fig.height=3.5}
X = multi %>% 
    filter(n_pres > 2)

X %>% ggplot(aes(rel_strength, second_pres_time)) + 
    stat_summary_bin(fun.data=mean_cl_boot, bins=10) +
    facet_wrap(~ phase) +
    geom_smooth(method='lm')

X %>% filter(phase == "early") %>% lmer(second_pres_time ~ rel_strength + (rel_strength|wid), data=.) %>% summ
X %>% filter(phase == "late") %>% lmer(second_pres_time ~ rel_strength + (rel_strength|wid), data=.) %>% summ
```

Stronger and more reliable result in late trials.


# Third fixation duration

Can we push it further?

```{r, fig.width=7, fig.height=3.5}
X = multi %>% 
    filter(n_pres > 3) %>% 
    mutate(third_pres_time = map_dbl(presentation_times, 3, .default=NaN))

X %>% ggplot(aes(rel_strength, third_pres_time)) + 
    stat_summary_bin(fun.data=mean_cl_boot, bins=10) +
    facet_wrap(~ phase) +
    geom_smooth(method='lm')

X %>% filter(phase == "early") %>% lmer(third_pres_time ~ rel_strength + (rel_strength|wid), data=.) %>% summ
X %>% filter(phase == "late") %>% lmer(third_pres_time ~ rel_strength + (rel_strength|wid), data=.) %>% summ
```

This one is quite striking.


::: {.alert .alert-info}
**Concluision:** It looks like overall the effects become stronger and more reliable over time.
:::




